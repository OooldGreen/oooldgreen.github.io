<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>计算机网络 | Snow Cabin</title><meta name=keywords content="class note,computer network"><meta name=description content="Computer Network is a MOOC class."><meta name=author content="Silva"><link rel=canonical href=/posts/cs/computer-networks/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.464f9b77111bda4aee49bf2ad1987e36490fb9f4103f2d1b02945f1f0e06ac94.css integrity="sha256-Rk+bdxEb2kruSb8q0Zh+NkkPufQQPy0bApRfHw4GrJQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=apple-touch-icon href=%3Clink%20/%20absolute%20url%3E><link rel=mask-icon href=%3Clink%20/%20absolute%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link href=https://fonts.cdnfonts.com/css/montserrat rel=stylesheet><link href=https://fonts.cdnfonts.com/css/freemono rel=stylesheet><progress id=content_progress value=0></progress>
<script>document.addEventListener("DOMContentLoaded",function(){var t=window.innerHeight,n=document.documentElement.scrollHeight,e=document.querySelector("#content_progress");e.max=n-t,e.value=window.scrollY,document.addEventListener("scroll",function(){e.max=document.documentElement.scrollHeight-window.innerHeight,e.value=window.scrollY})})</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css integrity=sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js integrity=sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="计算机网络"><meta property="og:description" content="Computer Network is a MOOC class."><meta property="og:type" content="article"><meta property="og:url" content="/posts/cs/computer-networks/"><meta property="og:image" content><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-14T15:57:02+08:00"><meta property="article:modified_time" content="2022-11-28T19:00:00+08:00"><meta property="og:site_name" content="Snow Cabin"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content><meta name=twitter:title content="计算机网络"><meta name=twitter:description content="Computer Network is a MOOC class."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"/posts/"},{"@type":"ListItem","position":3,"name":"CS","item":"/posts/cs/"},{"@type":"ListItem","position":4,"name":"计算机网络","item":"/posts/cs/computer-networks/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"计算机网络","name":"计算机网络","description":"Computer Network is a MOOC class.","keywords":["class note","computer network"],"articleBody":"《计算机网络（自顶向下方法 第7版，James F.Kurose，Keith W.Ross）》 课程 是 2020 年秋科大自动化系本科课程录制版。在介绍计算机网络体系架构的基础上，自上而下、以互联网为例系统地阐述了网络体系结构各层次的主要服务、工作原理、常用技术和协议，包括应用层、传输层、网络层、数据链路层和物理层，最后是网络安全原理和协议。\n计算机网络和互联网 Internet：是一堆的网络，通过一系列网络交换节点互联互通，向用户提供服务。互联网是分布式的应用进程和提供通信服务的基础设施（应用层以下都是）。\nInternet 标准：\nRFC IETF 互联网组成：\n节点 节点及主机上的应用程序 路由器（网络层）、交换机（链路层）等网络交换设备 边 access 接入网链路 backbone 主干链路 协议：根据协议发出请求和接受请求，按照规范解析报文。协议规范了语法、语义、时序、动作四个方面。 互联网的三个子系统：\n边缘 (edge) ：存在网络应用和支撑其运行的协议栈 核心 (core) ：进行数据交换，是由路由和交换机构成的分布式系统 接入 (access)：把边缘接入到网络核心，通过网络核心将数据发送给目标主机，可以有有线或无线通信链路 网络边缘 (edge) 应用进程之间的通信模式 客户端/服务器模式 (CS 模式) 资源在服务器，以服务器为主，服务器支撑，由客户端向服务器请求资源 典型的主从模式 缺点：服务器压力大，服务器通信消耗大，服务器宕机影响大，性能随业务量增加断崖式下降 对等 (peer-peer, P2P) 模式 很少（甚至没有）专门的服务器，每个节点既是客户端，又是服务器 面向连接的服务 目标是在端系统之间传输数据。需要在数据传输之前做好准备（握手），例如 TCP 协议。\nTCP 服务的特性：\n面相连接 可靠的（不重复、不失序、不出错、不丢失） 流量控制（协调发送方发送速度和接收方接收速度） 拥塞控制（考虑网络路径的通行能力） 应用场景：可靠性要求高的应用 UDP（用户数据报）服务的特性：\n无连接的服务，不需要握手 不可靠 无流量控制，无拥塞控制 快速 将端口细分到进程到进程 应用场景：实时流媒体，远程会议，域名解析等 网络核心 (core) 关键功能有路由和转发\n1. 电路交换\n端到端的资源被分配给从源端到目标端的呼叫 “call”，为每个呼叫预留一条专有通道进行数据交换。\n每条链路被分为若干不同的 pieces，每个呼叫分配独享的链路，资源专用，不共享，这样连接一建立起来就能保证性能，但是会有资源浪费的缺陷，通常被传统电话网络采用，不太适合计算机之间的通信。\n将带宽分成片的方法：频分 (FDM)、时分 (TDM)、波分 (WDM)\n不适合计算机之间通信的原因：\n连接建立时间长 计算机之间通信有突发性，浪费的片较多（独享链接没有被使用的时候也无法被别的呼叫使用） 可靠性不高 2. 分组交换\n以分组 (package) 为单位，在每一个单位节点经历存储再转发，使用带宽的全部，资源共享，按需使用。\n统计多路复用：分组没有固定的模式\n数据存储-转发的方式：\n数据报网络：无连接，每个分组传送是独立的，标识完整的目标主机地址，直接传输。 虚电路网络 (virtual circuit)：有连接，先握手，在交换节点之间先建立虚拟的电路，确保网络层的连接，然后每个分组携带虚电路号进行存储转发。虚电路靠信令建立起来。 有连接和面向连接：\n有连接体现在每一跳的节点上都是有连接的。 面向连接只体现在发送和接收端连接 优点：\n支持的用户更多 共享性 适合突发式的数据传输 缺点：\n时延是在每个交换节点中存储的时间之和 和 不太确定的排队时延 如果路由器缓存用完了，分组将会被抛弃（丢包） 过度使用会造成网络拥塞 接入网 (access) modem：调制解调器 DSL/IDSL：仍然用调制解调的方式，用 4kHz 以上的带宽，分上行和下行链路 线缆网络：有线电缆双向改造，在不同频段传输不同信道的数据，上下行 家庭网络 企业接入网络：直接接到以太网路交换机上 无线接入网络：\nWlan 广域无线接入 (wide-area，蜂窝网络、3G、4G、5G等) 无线局域网 WIFI 物理媒体：\n导引型媒体：有形的 例如同轴电缆（两根同心的铜导线）、光纤（单/多模）、光缆、双绞线 低误码率，双向，高速，安全 非导引型媒体：传输电磁波，携带要传输的数据 例如地面微波、LAN、wide-area、卫星等 无需物理“线缆”，双向，有反射、吸收、干扰 互联网结构\n端系统通过接入 ISPs (Internet Service Providers) 连接到互联网，ISP 也要互相连接，但每两个 ISP 互相连接不具有扩展性，可以将每个接入 ISP 都连接到全局 ISP (Global ISP)，客户 ISPs 和提供者 ISPs 有经纪合约 ISP 之间合作可以完成业务的扩展，对等互联 (peer linking) 的结算关系 多个 ISP 接入入互联网交换点 IXP (Internet exchange point) 内容提供者 ICP (Internet Content Providers) 费用高，范围有限，需要部署 DC (data center)，通常部署在离 ISP 较近的地方，用专用线缆连在一起 互联网层次结构是松散的：\n中心：第一层 ISP，国家覆盖，效率极高 第二层 ISP：更小些的（通常是区域性的）ISP 第三层：Local ISP ICP等 ISP 之间的连接：\nPOP：高层 ISP 向低层接入，涉及费用结算 多宿 (multi home)：低层 ISP 向多个高层 ISP 接入 IXP：对等连接，通常不涉及费用结算 ICP自己部署的专用网络，同时和各级 ISP 连接 延时、丢失和吞吐量分析 分组延时\n节点处理延时 排队延时\n根据当时网络情况\n流量强度 = L*a/R\n流量强度趋近于 0，排队延时很小；流量强度趋近于 1，延时变得很大，趋近于无穷大；设计系统时流量强度不能大于 1。 传输延时：L/R 传播延时：d/s 分组丢失：链路的队列缓冲区容量有限，分组到达一个满的队列就会被丢失，丢失的分组可能会被前一个节点或源端系统重传也可能根本不重传\n吞吐量：在源端和目标端之间传输的速率（数据量/单位时间）\n瓶颈链路：端到端路径上，限制端到端吞吐的链路\n协议层次 把网络复杂的功能分成功能明确的层次，每一层实现一个或一组功能，功能中有其上层能够使用的功能 —— 服务。本层借助层间的接口访问下层提供的服务，通过协议交换信息。\n服务 (Service)：低层实体向上层实现提供他们之间通信的能力\n原语 (primitive)：上层使用下层服务的形式\n服务访问点 (SAP, Services Access Point)：使用下层提供的服务通过层间的接口地点\n服务和协议的差别和关系：\n服务：垂直，低层向上层提供的，通过原语操作 协议：对等层互相通信的过程中遵循的集合 联系：本层协议的实现靠下层提供的服务来实现，本层实体通过协议为上层提供更高级的服务 数据单元 (DU, data unit) SDU 处理：\n一对一的关系：上层发送了一个数据单元，没有超出分组大小，直接加上 header 成为 n-PDU (protocol data unit) 一对多的关系：上层发送的一个数据单元太大了，需要拆解成分组大小 多对一的关系：上层发送很多个非常小的数据单元，下层将数据单元组合成一个分组 分层系统的优缺点：\n对付复杂的系统 概念化：结构清晰，便于交流和讨论 结构化：模块化易于维护和系统升级 子系统相互交换信息降低了效率 Internet 协议栈 应用层：应用报文 (message) 之间的交互，提供网络应用服务 传输层：报文段 (message segment)，TCP 段，UDP 数据报，进程到进程的区分，网络层提供的有可能不可靠的服务变成可靠的服务 网络层：源主机到目标主机，以分组（packet, 或无连接的方式: 数据报 datagram）为单位的端到端的数据传输，重要任务转发、路由 链路层：在相邻两点间传输以帧 (frame) 为单位的数据，交换机 物理层：在线路上传输位 (bit) ISO/OSI 参考模型 应用层 表示层：允许应用解释传输的数据，加密、压缩、机器相关的表示转换 会话层：建立会话管理，数据交换的同步，检查点，恢复 传输层 网络层 链路层 物理层 应用层 原理 进程通信 进程：在主机上运行的应用程序\n客户端进程：发起通信的进程 服务器进程：等待连接的进程 区分不同的进程：寻址-标识\n用IP地址和端口号标识 任何应用进程之间都可以用两个端节点来表示（end point） Socket 采用 Socket 减少层间传输的信息量，并且便于管理，实际上是一个整数。就像 OS 打开文件返回的句柄一样，对句柄操作就是对文件的操作。\nTCP Socket：\n两个进程通信持续一段时间，通信关系稳定，本质是用一个整数表示两个应用实体之间的通信关系，是一个具有本地意义的标示，包括 ——\n四元组：源IP、源端口、目标 IP、目标端口\n传输报文的时候交两样东西：socket 和数据本身\nUDP Socket：\n由于不需要建立连接，内容只有二元组：本 IP、本端口，仅代表一个端节点\n传输报文的时候交三样东西：socket、数据本身 和 对方的 IP 和 port\n应用层协议 运行在不同端系统上的应用进程如何进行交换报文\n公开协议：由 RFC 文档定义，允许互操作，如 HTTP、SMTP\n私有协议：不公开，如 Skype\nTCP 和 UDP 都不提供安全性\n怎么增加安全性？\n安全 TCP：\nSSL 加密，提供加密的 TCP 连接 私密性 数据完整性 端到端的鉴别 Web 和 HTTP Web 页由一些对象组成，，对象可以是 HTML 文件， JPEG 图像，Java 小程序等，通过 URL 对每个对象进行引用。\nURL格式：\n协议 - 用户：口令 - 主机名 - 路径名 - 端口\n1 Prot://user:psw@www.someSchool.edu/someDept/pic.gif:port HTTP HTTP 即超文本传输协议，是 Web 的应用层协议，使用客户/服务器模式，客户端负责请求、接收和显示 Web 对象（各种浏览器），服务端负责对请求进行相应并发送浏览器（服务器）。\nHTTP 是无状态的，使用 TCP ，客户发起 TCP 连接默认端口号为 80，在浏览器交换 HTTP 报文之后连接关闭。\n无状态：服务器不需要维护客户端的状态，无记忆\n往返时间 (RTT, round-trip time)：一个小的分组从客户端到服务器再回到服务端的时间（字节数很少可以忽略传输时间）\n响应时间：包括一个 RTT 发起 TCP 连接，一个 RTT 请求 HTTP 并等待 HTTP 响应 ，文件传输时间（这样一个大的对象传输时间无法忽略）= 2 * RTT + 传输时间\nHTTP 请求格式：\n请求报文格式：请求行、首部行、换行回车符，表示报文结束 1 2 3 4 5 6 GET /somedir/page,html HTTP/1.1 Host: www.someschool.edu User-agent: Mozilla/4.0 Connection: close Accept-language: fr （一个额外的换行回车符） 响应报文：状态行（协议版本/状态码/响应状态信息）、首部行、数据（如请求的 HTML 文件） 状态码：\n200 Ok 301 Move Permanently 400 Bad Request 404 Not Found 505 Http Version not Supported HTTP 1.0 请求方式：\nGET POST HEAD：要求服务器在响应报文中不包含请求对象 -\u003e 故障跟踪 HTTP 1.1 请求方式；\nGET/POST/HEAD PUT：实体主体中的文件上载到 URL 字段规定的路径 DELETE：删除 URL 字段规定的文件 默认连接方式：流水方式的持久 HTTP 连接，客户端向客户端连接请求，建立连接之后默认不关闭连接。客户端遇到一个引用对象就立即产生一个请求，所有引用对象指花费一个 RTT 是有可能的。\nCookie 可以使连接有状态的小甜饼～\n在 HTTP 响应报文中有一个 cookie 的首部行 请求报文中含有一个 cookie 的首部行 用户端系统中保留一个 cookie 文件 在 web 站点有一个后端数据库 能做什么呢？举例：\n用户验证 购物车 个性化推荐 缺点是隐私性问题，cookie 不够安全，会暴露你的访问行为，被攻击后信息也会暴露\nWeb 缓存：不访问服务器就满足用户的需求，可以降低服务器的负载，降低客户端请求响应时间，通常由 ISP 安装\nFTP 文件传输协议，端口号为 21，客户端通过控制连接（带外传送）完成用户认证，之后可以发出一系列指令传输文件（上载或下载等）\nFTP 命令、响应\nUSER username PASS password LIST RETER filename 311 Username OK, password required Email 电子邮件 3个主要组成部分：\n用户代理：客户端软件，Outlook，Gmail 等 邮件服务器：管理和维护发送给用户的邮件，输出报文队列保持待发送邮件报文 简单邮件传输协议：SMTP，使用 TCP 在客户端和服务器之间传送 email 报文，端口号 25，使用持久报文，要求报文为 ASCII 编码 邮件访问协议：\nPOP (Post Office Protocol)：邮局访问协议 IMAP (Internet Mail Access Protocol)：邮件访问协议，更多特性，在服务器上处理存储的报文 HTTP：web 访问，文件上载下载，收发邮件 DNS 域名 DNS (Domain Name System), 应用于其他应用的应用。IP 地址标识主机、路由器，不容易记忆，所以用有意义的字符串来标识地址，由 DNS 负责转换成为二进制的网络地址。DNS 运行在 53 号端口，在边缘系统中实现，主要思路是分层的命名（防止重名）、分布式的数据库。\nDNS 目的：\n主要目的：完成主机 - IP 地址的转换 其他目的有 主机别名到规范名的转换 邮件服务器别名到邮件服务器正规名转换 负载均衡 DNS 域名结构：\n层次树状结构 Internet 根被划为几百个顶级域 按国家分: .jp; .cn 按通用的 (genetic): .com; .gov; .edu; .int; .mil; .net; .org; .web … 每个域下面还可以划分若干个子域 树叶是主机 名字服务器：\n区域 (zone)：域名，将 DNS 名字空间划分为互不相交的区域，每个区域都是树的一部分 每个区域都有一个名字服务器 允许被放置在区域之外保障可靠性 权威 DNS 服务器：组织机构的 DNS 服务器，提供组织机构服务器可访问的主机和 IP 之间的映射，组织机构可以选择实现自己维护或者某个服务提供商维护 TLD 服务器（顶级域服务器）： 负责顶级域名和所有国家顶级域名\n资源记录 (RR) 区域名字服务器维护的资源记录，RR 格式：(name, value, type, ttl)\n内容包括：\nDomain_name 域名 TTL (time to live)：生存时间（权威记录/缓冲记录），权威记录 TTL 可以无限大，永久存在 Class 类别：如果是 Internet，是 IN Value 值 Type 类别 Type:\nA - name 为主机 CNAME - name 为规范名字的别名 NS - name 域名 MX - name为对应 mail 服务器名字 P2P 模式应用 Peer to Peer，每个节点既是客户端也是服务端，是一类应用\n优点：分布式流量，可靠性较高\n用例：\n文件的分发 流媒体点播 VoIP (Skype) 实时音频视频 overlay：客户端配置文件中给出一个列表，记录若干个经常运行的节点的 IP，向这些节点按照协议发出连接报文，在响应中随机选取节点建立起 overlay\n非结构化 P2P：覆盖网络 (overlay) 中节点间的关系是随意的\n集中化目录 完全分布式：限制范围的泛洪 (flooding) 查询，例如 TTL，进行标记 混合体：例如 BitTorrent 结构化 (DHT, Distributed Hash Table) P2P：节点间可以构成有序的 overlay（树、环等）\nCDN (Content Distribution/Delivery Networks) 多媒体流化服务：DASH (Dynamic, Adaptive Streaming over HTTP)\n智能客户端：客户端自适应决定 —— 什么时候请求块，请求什么编码速率的视频块，哪里请求块\nCDN: 部署缓存节点，存储服务内容，就近为用户提供服务\nSocket 编程 socket：分布式应用进程之间的门，传输层协议提供的端到端服务接口\nTCP 套接字编程\n服务器端 服务器先运行，创建欢迎 socket 和本地端口捆绑 bind 建立 connetionSocket，连接 welcomeSocket，阻塞式等待用户连接 客户端 4. 客户端创建 clientSocket，隐式绑定（操作系统自动分配）\n5. 主动和服务端建立连接，connect(ClientSocket, sad)，记录服务器 IP 和端口 连接通信\n6. 服务器端接受连接，返回一个有效值，解除阻塞，建立连接\n7. 客户端发送请求 send request\n8. 服务器调用 read 接收，write 回复\n9. 客户端从服务器读取 read reply UDP Socket 编程\n没有握手，服务器和客户端没有连接 传送的数据可能乱序也可能丢失 建立 serverSocket bind readfrom，等待客户端发送数据 客户端创建 clientSocket 客户端隐式 bind 客户端 sendto 发送数据 服务端 readfrom 解除阻塞，sendto 返回数据 客户端 read reply from 读取服务端返回的数据 关闭 socket 传输层 ","wordCount":"744","inLanguage":"en","datePublished":"2022-11-14T15:57:02+08:00","dateModified":"2022-11-28T19:00:00+08:00","author":{"@type":"Person","name":"Silva"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/cs/computer-networks/"},"publisher":{"@type":"Organization","name":"Snow Cabin","logo":{"@type":"ImageObject","url":"/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="SNOW CABIN (Alt + H)"><img src=/snowman.png alt aria-label=logo height=35>SNOW CABIN</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/archives/ title=Archive><span>Archive</span></a></li><li><a href=/categories/ title=Categories><span>Categories</span></a></li><li><a href=/tags/ title=Tags><span>Tags</span></a></li><li><a href=/about/ title=About><span>About</span></a></li></ul><div id=menu2><button onclick=done() id=guideBtn class=guideBtn><svg viewBox="0 0 100 80" width="25" height="25" fill="var(--primary)"><rect width="100" height="10" rx="2"/><rect y="30" width="100" height="10" rx="2"/><rect y="60" width="100" height="10" rx="2"/></svg></button></div><nav id=guide style=display:none><ul class=guide-ul><li><a href=/archives/ title=Archive><span>Archive</span></a></li><li><a href=/categories/ title=Categories><span>Categories</span></a></li><li><a href=/tags/ title=Tags><span>Tags</span></a></li><li><a href=/about/ title=About><span>About</span></a></li></ul></nav></nav></header><script type=text/javascript>var guideBtn=document.getElementById("guideBtn"),guide=document.getElementById("guide");function done(){guide.style.display=="none"?guide.style.display="block":guide.style.display="none"}</script><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href>Home</a>
&nbsp; > &nbsp;<a href=/posts/>Posts</a>
&nbsp; > &nbsp;<a href=/posts/cs/>CS</a></div><h1 class=post-title>计算机网络</h1><div class=post-description>Computer Network is a MOOC class.</div><div class=post-meta><span title='2022-11-14 15:57:02 +0800 CST'>November 14, 2022</span>&nbsp;&nbsp;<span>[LastMod:&nbsp;November 28, 2022]</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c%e5%92%8c%e4%ba%92%e8%81%94%e7%bd%91 aria-label=计算机网络和互联网>计算机网络和互联网</a><ul><li><a href=#%e7%bd%91%e7%bb%9c%e8%be%b9%e7%bc%98-edge aria-label="网络边缘 (edge)">网络边缘 (edge)</a><ul><li><a href=#%e5%ba%94%e7%94%a8%e8%bf%9b%e7%a8%8b%e4%b9%8b%e9%97%b4%e7%9a%84%e9%80%9a%e4%bf%a1%e6%a8%a1%e5%bc%8f aria-label=应用进程之间的通信模式>应用进程之间的通信模式</a></li><li><a href=#%e9%9d%a2%e5%90%91%e8%bf%9e%e6%8e%a5%e7%9a%84%e6%9c%8d%e5%8a%a1 aria-label=面向连接的服务>面向连接的服务</a></li></ul></li><li><a href=#%e7%bd%91%e7%bb%9c%e6%a0%b8%e5%bf%83-core aria-label="网络核心 (core)">网络核心 (core)</a></li><li><a href=#%e6%8e%a5%e5%85%a5%e7%bd%91-access aria-label="接入网 (access)">接入网 (access)</a></li><li><a href=#%e5%bb%b6%e6%97%b6%e4%b8%a2%e5%a4%b1%e5%92%8c%e5%90%9e%e5%90%90%e9%87%8f%e5%88%86%e6%9e%90 aria-label=延时、丢失和吞吐量分析>延时、丢失和吞吐量分析</a></li><li><a href=#%e5%8d%8f%e8%ae%ae%e5%b1%82%e6%ac%a1 aria-label=协议层次>协议层次</a><ul><li><a href=#internet-%e5%8d%8f%e8%ae%ae%e6%a0%88 aria-label="Internet 协议栈">Internet 协议栈</a></li><li><a href=#isoosi-%e5%8f%82%e8%80%83%e6%a8%a1%e5%9e%8b aria-label="ISO/OSI 参考模型">ISO/OSI 参考模型</a></li></ul></li></ul></li><li><a href=#%e5%ba%94%e7%94%a8%e5%b1%82 aria-label=应用层>应用层</a><ul><li><a href=#%e5%8e%9f%e7%90%86 aria-label=原理>原理</a><ul><li><a href=#socket aria-label=Socket>Socket</a></li><li><a href=#%e5%ba%94%e7%94%a8%e5%b1%82%e5%8d%8f%e8%ae%ae aria-label=应用层协议>应用层协议</a></li><li><a href=#tcp-%e5%92%8c-udp aria-label="TCP 和 UDP">TCP 和 UDP</a></li></ul></li><li><a href=#web-%e5%92%8c-http aria-label="Web 和 HTTP">Web 和 HTTP</a><ul><li><a href=#http aria-label=HTTP>HTTP</a></li><li><a href=#cookie aria-label=Cookie>Cookie</a></li><li><a href=#ftp aria-label=FTP>FTP</a></li><li><a href=#email-%e7%94%b5%e5%ad%90%e9%82%ae%e4%bb%b6 aria-label="Email 电子邮件">Email 电子邮件</a></li></ul></li><li><a href=#dns-%e5%9f%9f%e5%90%8d aria-label="DNS 域名">DNS 域名</a><ul><li><a href=#%e8%b5%84%e6%ba%90%e8%ae%b0%e5%bd%95-rr aria-label="资源记录 (RR)">资源记录 (RR)</a></li></ul></li><li><a href=#p2p-%e6%a8%a1%e5%bc%8f%e5%ba%94%e7%94%a8 aria-label="P2P 模式应用">P2P 模式应用</a></li><li><a href=#cdn-content-distributiondelivery-networks aria-label="CDN (Content Distribution/Delivery Networks)">CDN (Content Distribution/Delivery Networks)</a></li><li><a href=#socket-%e7%bc%96%e7%a8%8b aria-label="Socket 编程">Socket 编程</a></li></ul></li><li><a href=#%e4%bc%a0%e8%be%93%e5%b1%82 aria-label=传输层>传输层</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>《计算机网络（自顶向下方法 第7版，James F.Kurose，Keith W.Ross）》 <a href=https://b23.tv/u8AvdXv>课程</a> 是 2020 年秋科大自动化系本科课程录制版。在介绍计算机网络体系架构的基础上，自上而下、以互联网为例系统地阐述了网络体系结构各层次的主要服务、工作原理、常用技术和协议，包括应用层、传输层、网络层、数据链路层和物理层，最后是网络安全原理和协议。</p><h1 id=计算机网络和互联网>计算机网络和互联网<a hidden class=anchor aria-hidden=true href=#计算机网络和互联网>#</a></h1><p>Internet：是一堆的网络，通过一系列网络交换节点互联互通，向用户提供服务。互联网是分布式的应用进程和提供通信服务的基础设施（应用层以下都是）。</p><p>Internet 标准：</p><ul><li>RFC</li><li>IETF</li></ul><p>互联网组成：</p><ul><li>节点<ul><li>节点及主机上的应用程序</li><li>路由器（网络层）、交换机（链路层）等网络交换设备</li></ul></li><li>边<ul><li>access 接入网链路</li><li>backbone 主干链路</li></ul></li><li>协议：根据协议发出请求和接受请求，按照规范解析报文。协议规范了语法、语义、时序、动作四个方面。</li></ul><p>互联网的三个子系统：</p><ul><li>边缘 (edge) ：存在网络应用和支撑其运行的协议栈</li><li>核心 (core) ：进行数据交换，是由路由和交换机构成的分布式系统</li><li>接入 (access)：把边缘接入到网络核心，通过网络核心将数据发送给目标主机，可以有有线或无线通信链路</li></ul><h2 id=网络边缘-edge>网络边缘 (edge)<a hidden class=anchor aria-hidden=true href=#网络边缘-edge>#</a></h2><h3 id=应用进程之间的通信模式>应用进程之间的通信模式<a hidden class=anchor aria-hidden=true href=#应用进程之间的通信模式>#</a></h3><ul><li>客户端/服务器模式 (CS 模式)<ul><li>资源在服务器，以服务器为主，服务器支撑，由客户端向服务器请求资源</li><li>典型的主从模式</li><li>缺点：服务器压力大，服务器通信消耗大，服务器宕机影响大，性能随业务量增加断崖式下降</li></ul></li><li>对等 (peer-peer, P2P) 模式<ul><li>很少（甚至没有）专门的服务器，每个节点既是客户端，又是服务器</li></ul></li></ul><h3 id=面向连接的服务>面向连接的服务<a hidden class=anchor aria-hidden=true href=#面向连接的服务>#</a></h3><p>目标是在端系统之间传输数据。需要在数据传输之前做好准备（握手），例如 TCP 协议。</p><p>TCP 服务的特性：</p><ul><li>面相连接</li><li>可靠的（不重复、不失序、不出错、不丢失）</li><li>流量控制（协调发送方发送速度和接收方接收速度）</li><li>拥塞控制（考虑网络路径的通行能力）</li><li>应用场景：可靠性要求高的应用</li></ul><p>UDP（用户数据报）服务的特性：</p><ul><li>无连接的服务，不需要握手</li><li>不可靠</li><li>无流量控制，无拥塞控制</li><li>快速</li><li>将端口细分到进程到进程</li><li>应用场景：实时流媒体，远程会议，域名解析等</li></ul><h2 id=网络核心-core>网络核心 (core)<a hidden class=anchor aria-hidden=true href=#网络核心-core>#</a></h2><p>关键功能有路由和转发</p><p><strong>1. 电路交换</strong></p><p>端到端的资源被分配给从源端到目标端的呼叫 &ldquo;call&rdquo;，为每个呼叫预留一条专有通道进行数据交换。</p><p>每条链路被分为若干不同的 pieces，每个呼叫分配独享的链路，资源专用，不共享，这样连接一建立起来就能保证性能，但是会有资源浪费的缺陷，通常被传统电话网络采用，不太适合计算机之间的通信。</p><p>将带宽分成片的方法：频分 (FDM)、时分 (TDM)、波分 (WDM)</p><p>不适合计算机之间通信的原因：</p><ul><li>连接建立时间长</li><li>计算机之间通信有突发性，浪费的片较多（独享链接没有被使用的时候也无法被别的呼叫使用）</li><li>可靠性不高</li></ul><p><strong>2. 分组交换</strong></p><p>以分组 (package) 为单位，在每一个单位节点经历存储再转发，使用带宽的全部，资源共享，按需使用。</p><p>统计多路复用：分组没有固定的模式</p><p>数据存储-转发的方式：</p><ul><li>数据报网络：无连接，每个分组传送是独立的，标识完整的目标主机地址，直接传输。</li><li>虚电路网络 (virtual circuit)：有连接，先握手，在交换节点之间先建立虚拟的电路，确保网络层的连接，然后每个分组携带虚电路号进行存储转发。虚电路靠信令建立起来。</li></ul><blockquote><p>有连接和面向连接：</p><ul><li>有连接体现在每一跳的节点上都是有连接的。</li><li>面向连接只体现在发送和接收端连接</li></ul></blockquote><p>优点：</p><ul><li>支持的用户更多</li><li>共享性</li><li>适合突发式的数据传输</li></ul><p>缺点：</p><ul><li>时延是在每个交换节点中存储的时间之和 和 不太确定的排队时延</li><li>如果路由器缓存用完了，分组将会被抛弃（丢包）</li><li>过度使用会造成网络拥塞</li></ul><h2 id=接入网-access>接入网 (access)<a hidden class=anchor aria-hidden=true href=#接入网-access>#</a></h2><ol><li>modem：调制解调器</li><li>DSL/IDSL：仍然用调制解调的方式，用 4kHz 以上的带宽，分上行和下行链路</li><li>线缆网络：有线电缆双向改造，在不同频段传输不同信道的数据，上下行</li><li>家庭网络</li><li>企业接入网络：直接接到以太网路交换机上</li></ol><p>无线接入网络：</p><ul><li>Wlan</li><li>广域无线接入 (wide-area，蜂窝网络、3G、4G、5G等)</li><li>无线局域网 WIFI</li></ul><p>物理媒体：</p><ul><li>导引型媒体：有形的<ul><li>例如同轴电缆（两根同心的铜导线）、光纤（单/多模）、光缆、双绞线</li><li>低误码率，双向，高速，安全</li></ul></li><li>非导引型媒体：传输电磁波，携带要传输的数据<ul><li>例如地面微波、LAN、wide-area、卫星等</li><li>无需物理“线缆”，双向，有反射、吸收、干扰</li></ul></li></ul><hr><p>互联网结构</p><ul><li>端系统通过接入 ISPs (Internet Service Providers) 连接到互联网，ISP 也要互相连接，但每两个 ISP 互相连接不具有扩展性，可以将每个接入 ISP 都连接到全局 ISP (Global ISP)，客户 ISPs 和提供者 ISPs 有经纪合约</li><li>ISP 之间合作可以完成业务的扩展，对等互联 (peer linking) 的结算关系</li><li>多个 ISP 接入入互联网交换点 IXP (Internet exchange point)</li><li>内容提供者 ICP (Internet Content Providers) 费用高，范围有限，需要部署 DC (data center)，通常部署在离 ISP 较近的地方，用专用线缆连在一起</li></ul><p>互联网层次结构是松散的：</p><ul><li>中心：第一层 ISP，国家覆盖，效率极高</li><li>第二层 ISP：更小些的（通常是区域性的）ISP</li><li>第三层：Local ISP</li><li>ICP等</li></ul><p>ISP 之间的连接：</p><ul><li>POP：高层 ISP 向低层接入，涉及费用结算</li><li>多宿 (multi home)：低层 ISP 向多个高层 ISP 接入</li><li>IXP：对等连接，通常不涉及费用结算</li><li>ICP自己部署的专用网络，同时和各级 ISP 连接</li></ul><h2 id=延时丢失和吞吐量分析>延时、丢失和吞吐量分析<a hidden class=anchor aria-hidden=true href=#延时丢失和吞吐量分析>#</a></h2><p>分组延时</p><ol><li>节点处理延时</li><li>排队延时<br>根据当时网络情况<br>流量强度 = L*a/R<br>流量强度趋近于 0，排队延时很小；流量强度趋近于 1，延时变得很大，趋近于无穷大；设计系统时流量强度不能大于 1。</li><li>传输延时：L/R</li><li>传播延时：d/s</li></ol><p>分组丢失：链路的队列缓冲区容量有限，分组到达一个满的队列就会被丢失，丢失的分组可能会被前一个节点或源端系统重传也可能根本不重传</p><p>吞吐量：在源端和目标端之间传输的速率（数据量/单位时间）<br>瓶颈链路：端到端路径上，限制端到端吞吐的链路</p><h2 id=协议层次>协议层次<a hidden class=anchor aria-hidden=true href=#协议层次>#</a></h2><p>把网络复杂的功能分成功能明确的层次，每一层实现一个或一组功能，功能中有其上层能够使用的功能 —— 服务。本层借助层间的接口访问下层提供的服务，通过协议交换信息。</p><p>服务 (Service)：低层实体向上层实现提供他们之间通信的能力<br>原语 (primitive)：上层使用下层服务的形式<br>服务访问点 (SAP, Services Access Point)：使用下层提供的服务通过层间的接口地点</p><p>服务和协议的差别和关系：</p><ul><li>服务：垂直，低层向上层提供的，通过原语操作</li><li>协议：对等层互相通信的过程中遵循的集合</li><li>联系：本层协议的实现靠下层提供的服务来实现，本层实体通过协议为上层提供更高级的服务</li></ul><p>数据单元 (DU, data unit) SDU 处理：</p><ul><li>一对一的关系：上层发送了一个数据单元，没有超出分组大小，直接加上 header 成为 n-PDU (protocol data unit)</li><li>一对多的关系：上层发送的一个数据单元太大了，需要拆解成分组大小</li><li>多对一的关系：上层发送很多个非常小的数据单元，下层将数据单元组合成一个分组</li></ul><p>分层系统的优缺点：</p><ul><li>对付复杂的系统<ul><li>概念化：结构清晰，便于交流和讨论</li><li>结构化：模块化易于维护和系统升级</li></ul></li><li>子系统相互交换信息降低了效率</li></ul><h3 id=internet-协议栈>Internet 协议栈<a hidden class=anchor aria-hidden=true href=#internet-协议栈>#</a></h3><ul><li>应用层：应用报文 (message) 之间的交互，提供网络应用服务</li><li>传输层：报文段 (message segment)，TCP 段，UDP 数据报，进程到进程的区分，网络层提供的有可能不可靠的服务变成可靠的服务</li><li>网络层：源主机到目标主机，以分组（packet, 或无连接的方式: 数据报 datagram）为单位的端到端的数据传输，重要任务转发、路由</li><li>链路层：在相邻两点间传输以帧 (frame) 为单位的数据，交换机</li><li>物理层：在线路上传输位 (bit)</li></ul><h3 id=isoosi-参考模型>ISO/OSI 参考模型<a hidden class=anchor aria-hidden=true href=#isoosi-参考模型>#</a></h3><ul><li>应用层</li><li>表示层：允许应用解释传输的数据，加密、压缩、机器相关的表示转换</li><li>会话层：建立会话管理，数据交换的同步，检查点，恢复</li><li>传输层</li><li>网络层</li><li>链路层</li><li>物理层</li></ul><h1 id=应用层>应用层<a hidden class=anchor aria-hidden=true href=#应用层>#</a></h1><h2 id=原理>原理<a hidden class=anchor aria-hidden=true href=#原理>#</a></h2><p>进程通信
进程：在主机上运行的应用程序</p><ul><li>客户端进程：发起通信的进程</li><li>服务器进程：等待连接的进程</li></ul><p>区分不同的进程：寻址-标识</p><ol><li>用IP地址和端口号标识</li><li>任何应用进程之间都可以用两个端节点来表示（end point）</li></ol><h3 id=socket>Socket<a hidden class=anchor aria-hidden=true href=#socket>#</a></h3><p>采用 Socket 减少层间传输的信息量，并且便于管理，实际上是一个<strong>整数</strong>。就像 OS 打开文件返回的句柄一样，对句柄操作就是对文件的操作。</p><p>TCP Socket：<br>两个进程通信持续一段时间，通信关系稳定，本质是用一个整数表示两个应用实体之间的通信关系，是一个具有本地意义的标示，包括 ——<br>四元组：源IP、源端口、目标 IP、目标端口<br>传输报文的时候交两样东西：socket 和数据本身</p><p>UDP Socket：<br>由于不需要建立连接，内容只有二元组：本 IP、本端口，仅代表一个端节点<br>传输报文的时候交三样东西：socket、数据本身 和 对方的 IP 和 port</p><h3 id=应用层协议>应用层协议<a hidden class=anchor aria-hidden=true href=#应用层协议>#</a></h3><p>运行在不同端系统上的应用进程如何进行交换报文</p><p>公开协议：由 RFC 文档定义，允许互操作，如 HTTP、SMTP</p><p>私有协议：不公开，如 Skype</p><h3 id=tcp-和-udp>TCP 和 UDP<a hidden class=anchor aria-hidden=true href=#tcp-和-udp>#</a></h3><p>都不提供安全性</p><p>怎么增加安全性？</p><p>安全 TCP：</p><ul><li>SSL 加密，提供加密的 TCP 连接</li><li>私密性</li><li>数据完整性</li><li>端到端的鉴别</li></ul><h2 id=web-和-http>Web 和 HTTP<a hidden class=anchor aria-hidden=true href=#web-和-http>#</a></h2><p>Web 页由一些对象组成，，对象可以是 HTML 文件， JPEG 图像，Java 小程序等，通过 URL 对每个对象进行引用。</p><p>URL格式：<br>协议 - 用户：口令 - 主机名 - 路径名 - 端口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Prot://user:psw@www.someSchool.edu/someDept/pic.gif:port
</span></span></code></pre></td></tr></table></div></div><h3 id=http>HTTP<a hidden class=anchor aria-hidden=true href=#http>#</a></h3><p>HTTP 即超文本传输协议，是 Web 的应用层协议，使用客户/服务器模式，客户端负责请求、接收和显示 Web 对象（各种浏览器），服务端负责对请求进行相应并发送浏览器（服务器）。<br>HTTP 是无状态的，使用 TCP ，客户发起 TCP 连接默认端口号为 80，在浏览器交换 HTTP 报文之后连接关闭。</p><blockquote><p>无状态：服务器不需要维护客户端的状态，无记忆</p></blockquote><p><strong>往返时间 (RTT, round-trip time)</strong>：一个小的分组从客户端到服务器再回到服务端的时间（字节数很少可以忽略传输时间）<br><strong>响应时间</strong>：包括一个 RTT 发起 TCP 连接，一个 RTT 请求 HTTP 并等待 HTTP 响应 ，文件传输时间（这样一个大的对象传输时间无法忽略）= 2 * RTT + 传输时间</p><p>HTTP 请求格式：</p><ul><li>请求报文格式：请求行、首部行、换行回车符，表示报文结束<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GET /somedir/page,html HTTP/1.1
</span></span><span class=line><span class=cl>Host: www.someschool.edu
</span></span><span class=line><span class=cl>User-agent: Mozilla/4.0
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>Accept-language: fr  
</span></span><span class=line><span class=cl>（一个额外的换行回车符）
</span></span></code></pre></td></tr></table></div></div></li><li>响应报文：状态行（协议版本/状态码/响应状态信息）、首部行、数据（如请求的 HTML 文件）</li></ul><p>状态码：</p><ul><li>200 Ok</li><li>301 Move Permanently</li><li>400 Bad Request</li><li>404 Not Found</li><li>505 Http Version not Supported</li></ul><p>HTTP 1.0 请求方式：</p><ul><li>GET</li><li>POST</li><li>HEAD：要求服务器在响应报文中不包含请求对象 -> 故障跟踪</li></ul><p>HTTP 1.1 请求方式；</p><ul><li>GET/POST/HEAD</li><li>PUT：实体主体中的文件上载到 URL 字段规定的路径</li><li>DELETE：删除 URL 字段规定的文件</li></ul><p>默认连接方式：流水方式的持久 HTTP 连接，客户端向客户端连接请求，建立连接之后默认不关闭连接。客户端遇到一个引用对象就立即产生一个请求，所有引用对象指花费一个 RTT 是有可能的。</p><h3 id=cookie>Cookie<a hidden class=anchor aria-hidden=true href=#cookie>#</a></h3><p>可以使连接有状态的小甜饼～</p><ol><li>在 HTTP 响应报文中有一个 cookie 的首部行</li><li>请求报文中含有一个 cookie 的首部行</li><li>用户端系统中保留一个 cookie 文件</li><li>在 web 站点有一个后端数据库</li></ol><p>能做什么呢？举例：</p><ul><li>用户验证</li><li>购物车</li><li>个性化推荐</li></ul><p>缺点是隐私性问题，cookie 不够安全，会暴露你的访问行为，被攻击后信息也会暴露</p><hr><p>Web 缓存：不访问服务器就满足用户的需求，可以降低服务器的负载，降低客户端请求响应时间，通常由 ISP 安装</p><h3 id=ftp>FTP<a hidden class=anchor aria-hidden=true href=#ftp>#</a></h3><p>文件传输协议，端口号为 21，客户端通过控制连接（带外传送）完成用户认证，之后可以发出一系列指令传输文件（上载或下载等）</p><p>FTP 命令、响应</p><ul><li>USER username</li><li>PASS password</li><li>LIST</li><li>RETER filename</li><li>311 Username OK, password required</li></ul><h3 id=email-电子邮件>Email 电子邮件<a hidden class=anchor aria-hidden=true href=#email-电子邮件>#</a></h3><p>3个主要组成部分：</p><ul><li>用户代理：客户端软件，Outlook，Gmail 等</li><li>邮件服务器：管理和维护发送给用户的邮件，输出报文队列保持待发送邮件报文</li><li>简单邮件传输协议：SMTP，使用 TCP 在客户端和服务器之间传送 email 报文，端口号 25，使用持久报文，要求报文为 ASCII 编码</li></ul><p>邮件访问协议：</p><ul><li>POP (Post Office Protocol)：邮局访问协议</li><li>IMAP (Internet Mail Access Protocol)：邮件访问协议，更多特性，在服务器上处理存储的报文</li><li>HTTP：web 访问，文件上载下载，收发邮件</li></ul><h2 id=dns-域名>DNS 域名<a hidden class=anchor aria-hidden=true href=#dns-域名>#</a></h2><p>DNS (Domain Name System), 应用于其他应用的应用。IP 地址标识主机、路由器，不容易记忆，所以用有意义的字符串来标识地址，由 DNS 负责转换成为二进制的网络地址。DNS 运行在 53 号端口，在边缘系统中实现，主要思路是分层的命名（防止重名）、分布式的数据库。</p><p>DNS 目的：</p><ul><li>主要目的：完成主机 - IP 地址的转换</li><li>其他目的有<ul><li>主机别名到规范名的转换</li><li>邮件服务器别名到邮件服务器正规名转换</li><li>负载均衡</li></ul></li></ul><p>DNS 域名结构：</p><ul><li>层次树状结构</li><li>Internet 根被划为几百个顶级域<ul><li>按国家分: .jp; .cn</li><li>按通用的 (genetic): .com; .gov; .edu; .int; .mil; .net; .org; .web &mldr;</li></ul></li><li>每个域下面还可以划分若干个子域</li><li>树叶是主机</li></ul><p>名字服务器：</p><ul><li>区域 (zone)：域名，将 DNS 名字空间划分为互不相交的区域，每个区域都是树的一部分</li><li>每个区域都有一个名字服务器</li><li>允许被放置在区域之外保障可靠性</li><li>权威 DNS 服务器：组织机构的 DNS 服务器，提供组织机构服务器可访问的主机和 IP 之间的映射，组织机构可以选择实现自己维护或者某个服务提供商维护<blockquote><p>TLD 服务器（顶级域服务器）： 负责顶级域名和所有国家顶级域名</p></blockquote></li></ul><h3 id=资源记录-rr>资源记录 (RR)<a hidden class=anchor aria-hidden=true href=#资源记录-rr>#</a></h3><p>区域名字服务器维护的资源记录，RR 格式：(name, value, type, ttl)</p><p>内容包括：</p><ul><li>Domain_name 域名</li><li>TTL (time to live)：生存时间（权威记录/缓冲记录），权威记录 TTL 可以无限大，永久存在</li><li>Class 类别：如果是 Internet，是 IN</li><li>Value 值</li><li>Type 类别</li></ul><p>Type:</p><ul><li>A - name 为主机</li><li>CNAME - name 为规范名字的别名</li><li>NS - name 域名</li><li>MX - name为对应 mail 服务器名字</li></ul><h2 id=p2p-模式应用>P2P 模式应用<a hidden class=anchor aria-hidden=true href=#p2p-模式应用>#</a></h2><p>Peer to Peer，每个节点既是客户端也是服务端，是<strong>一类应用</strong></p><p>优点：分布式流量，可靠性较高</p><p>用例：</p><ul><li>文件的分发</li><li>流媒体点播</li><li>VoIP (Skype) 实时音频视频</li></ul><p>overlay：客户端配置文件中给出一个列表，记录若干个经常运行的节点的 IP，向这些节点按照协议发出连接报文，在响应中随机选取节点建立起 overlay</p><p>非结构化 P2P：覆盖网络 (overlay) 中节点间的关系是随意的</p><ul><li>集中化目录</li><li>完全分布式：限制范围的泛洪 (flooding) 查询，例如 TTL，进行标记</li><li>混合体：例如 BitTorrent</li></ul><p>结构化 (DHT, Distributed Hash Table) P2P：节点间可以构成有序的 overlay（树、环等）</p><h2 id=cdn-content-distributiondelivery-networks>CDN (Content Distribution/Delivery Networks)<a hidden class=anchor aria-hidden=true href=#cdn-content-distributiondelivery-networks>#</a></h2><p>多媒体流化服务：DASH (Dynamic, Adaptive Streaming over HTTP)</p><p>智能客户端：客户端自适应决定 —— 什么时候请求块，请求什么编码速率的视频块，哪里请求块</p><p>CDN: 部署缓存节点，存储服务内容，就近为用户提供服务</p><h2 id=socket-编程>Socket 编程<a hidden class=anchor aria-hidden=true href=#socket-编程>#</a></h2><p>socket：分布式应用进程之间的门，传输层协议提供的端到端服务接口</p><p><strong>TCP 套接字编程</strong></p><ul><li>服务器端<ol><li>服务器先运行，创建欢迎 socket</li><li>和本地端口捆绑 bind</li><li>建立 connetionSocket，连接 welcomeSocket，阻塞式等待用户连接</li></ol></li><li>客户端
4. 客户端创建 clientSocket，隐式绑定（操作系统自动分配）<br>5. 主动和服务端建立连接，connect(ClientSocket, sad)，记录服务器 IP 和端口</li><li>连接通信<br>6. 服务器端接受连接，返回一个有效值，解除阻塞，建立连接<br>7. 客户端发送请求 send request<br>8. 服务器调用 read 接收，write 回复<br>9. 客户端从服务器读取 read reply</li></ul><p><strong>UDP Socket 编程</strong></p><ul><li>没有握手，服务器和客户端没有连接</li><li>传送的数据可能乱序也可能丢失</li></ul><ol><li>建立 serverSocket</li><li>bind</li><li>readfrom，等待客户端发送数据</li><li>客户端创建 clientSocket</li><li>客户端隐式 bind</li><li>客户端 sendto 发送数据</li><li>服务端 readfrom 解除阻塞，sendto 返回数据</li><li>客户端 read reply from 读取服务端返回的数据</li><li>关闭 socket</li></ol><h1 id=传输层>传输层<a hidden class=anchor aria-hidden=true href=#传输层>#</a></h1></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/class-note/>class note</a></li><li><a href=/tags/computer-network/>computer network</a></li></ul><nav class=paginav><a class=prev href=/posts/frontend/vue2-elm-day2/><span class=title>« Prev</span><br><span>Vue2 Elm 项目记录 Day2</span></a>
<a class=next href=/posts/daily/test/><span class=title>Next »</span><br><span>Test 测试用例</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络 on twitter" href="https://twitter.com/intent/tweet/?text=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c&url=%2fposts%2fcs%2fcomputer-networks%2f&hashtags=classnote%2ccomputernetwork"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络 on reddit" href="https://reddit.com/submit?url=%2fposts%2fcs%2fcomputer-networks%2f&title=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络 on facebook" href="https://facebook.com/sharer/sharer.php?u=%2fposts%2fcs%2fcomputer-networks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络 on whatsapp" href="https://api.whatsapp.com/send?text=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c%20-%20%2fposts%2fcs%2fcomputer-networks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 计算机网络 on telegram" href="https://telegram.me/share/url?text=%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%bd%91%e7%bb%9c&url=%2fposts%2fcs%2fcomputer-networks%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article><script src=https://utteranc.es/client.js repo=OooldGreen/blog-sources issue-term=pathname theme=github-light crossorigin=anonymous async></script></main><footer class=footer><footer class=entry-footer><div class=social-icons><a href="https://github.com/OooldGreen?tab=repositories" target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/home target=_blank rel="noopener noreferrer me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=mailto:954895224@qq.com target=_blank rel="noopener noreferrer me" title=Email><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a href=index.xml target=_blank rel="noopener noreferrer me" title=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></footer><span>&copy; 2025 <a href>Snow Cabin</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><a href=/search aria-label=search-link title=Search class=search-link id=search-link accesskey=/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link"),mybutton2=document.getElementById("search-link");window.onscroll=function(){document.body.scrollTop>400||document.documentElement.scrollTop>400?(mybutton.style.visibility="visible",mybutton.style.opacity="1",mybutton2.style.visibility="visible",mybutton2.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0",mybutton2.style.visibility="hidden",mybutton2.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>